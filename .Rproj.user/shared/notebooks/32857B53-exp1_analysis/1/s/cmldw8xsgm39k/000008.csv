"0","veridical.mean.wpd <- mean(subset(exp1.diffs,Block==""Interaction Block 2"")$Difference)"
"0","#make a copy of the data to work with - we only need interaction block 2 data"
"0","exp1.data.by.block.pseudo <- dplyr::select(subset(exp1.data.by.block,Block==""Interaction Block 2""),-Block,-BlockNewlines)"
"0","#helper function to re-assign participants to pseudo-pairs - slightly laoborious"
"0","#in order to avoid mixing across conditions etc"
"0","reassign.pairs <- function(in.data) {"
"0","  #subset data by block and participant"
"0","  p1.6633 <- dplyr::select(subset(in.data,Participant==""P1"" & Condition==""Condition: 66-33""),-Participant,-ParticipantID)"
"0","  p2.6633 <- dplyr::select(subset(in.data,Participant==""P2"" & Condition==""Condition: 66-33""),-Participant,-ParticipantID)"
"0","  p1.8317 <- dplyr::select(subset(in.data,Participant==""P1"" & Condition==""Condition: 83-17""),-Participant,-ParticipantID)"
"0","  p2.8317 <- dplyr::select(subset(in.data,Participant==""P2"" & Condition==""Condition: 83-17""),-Participant,-ParticipantID)"
"0","  #randomise pair assignments"
"0","  p1.6633$Pair <- sample(p1.6633$Pair)"
"0","  p2.6633$Pair <- sample(p2.6633$Pair)"
"0","  p1.8317$Pair <- sample(p1.8317$Pair)"
"0","  p2.8317$Pair <- sample(p2.8317$Pair)"
"0","  diffs.pseudo.6633 <- merge(p1.6633,p2.6633,by=c('Condition','Pair'))"
"0","  diffs.pseudo.8317 <- merge(p1.8317,p2.8317,by=c('Condition','Pair'))"
"0","  diffs.pseudo <- rbind(diffs.pseudo.6633,diffs.pseudo.8317)"
"0","  "
"0","  #calculate absolute diffs"
"0","  diffs.pseudo$Difference <-"
"0","    abs(diffs.pseudo$ProportionMarkedSingulars.x-diffs.pseudo$ProportionMarkedSingulars.y)"
"0","  #remove unnecessary columns, reorder Block again"
"0","  diffs.pseudo <- dplyr::select(diffs.pseudo,-ProportionMarkedSingulars.x,-ProportionMarkedSingulars.y)"
"0","  "
"0","  #calculate and return mean"
"0","  mean(diffs.pseudo$Difference)"
"0","}"
"0","sampled.diffs <- replicate(1000,reassign.pairs(exp1.data.by.block.pseudo))"
"0","#report the mean of the sampled diffs"
"0","mean(sampled.diffs)"
"1","[1]"
"1"," 0.4572273"
"1","
"
"0","#this is the number of cases where we see the same or smaller within-pair difference"
"0","sum(sampled.diffs <= veridical.mean.wpd)"
"1","[1]"
"1"," 0"
"1","
"
"0","#this is the proportion of cases where we see the same or smaller within-pair difference"
"0","sum(sampled.diffs <= veridical.mean.wpd)/length(sampled.diffs)"
"1","[1]"
"1"," 0"
"1","
"
